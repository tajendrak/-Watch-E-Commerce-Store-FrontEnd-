<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Timeless Vault - Contact</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<nav>
  <a href="product.html">Products</a> |
  <a href="contact.html">Contact</a> |
  <a href="faq.html">FAQ</a>
</nav>

<header>
  <h1>Contact Us</h1>
  <p>Questions, feedback, or support — we’re here to help.</p>
</header>

<main>
  <section>
    <h2>Send us a message</h2>
    <div id="alertBox" role="status" aria-live="polite"></div>

    <!-- Disable browser autofill -->
    <form id="contactForm" novalidate autocomplete="off">
      <div>
        <label for="name">Full Name</label><br>
        <input id="name" name="name" required autocomplete="off"/>
      </div>

      <div>
        <label for="email">Email</label><br>
        <input id="email" name="email" type="email" required autocomplete="off"/>
      </div>

      <div>
        <label for="subject">Subject</label><br>
        <input id="subject" name="subject" required autocomplete="off"/>
      </div>

      <div>
        <label for="message">Message</label><br>
        <textarea id="message" name="message" rows="5" required autocomplete="off"></textarea>
      </div>

      <div>
        <button type="submit">Send Message</button>
        <button type="button" id="clearDraft">Clear Draft</button>
      </div>
      <p>Your draft is autosaved in this browser (Session Storage).</p>
    </form>
  </section>

  <section>
    <h2>Our Details</h2>
    <ul>
      <li><strong>Email:</strong> info@timevault.com</li>
      <li><strong>Phone:</strong> 011-98723144</li>
      <li><strong>Hours:</strong> Mon–Fri, 9:00–6:00</li>
      <li><strong>Address:</strong> 24, Watch Mechanic Street, Orlando</li>
    </ul>

    <h3>Map</h3>
    <iframe
      src="https://www.openstreetmap.org/export/embed.html?bbox=101.675%2C3.135%2C101.695%2C3.155&layer=mapnik&marker=3.145%2C101.685"
      loading="lazy"
      title="Store Location"
      width="100%"
      height="260"
      frameborder="0">
    </iframe>

    <h3>Recent Messages (Session)</h3>
    <div id="recentMessages">No messages yet.</div>
  </section>
</main>

<footer>
  <p>© <span id="year"></span> Watch Store. All rights reserved.</p>
</footer>

<script>
  // Footer year
  document.getElementById('year').textContent = new Date().getFullYear();

  // Session Storage keys
  const DRAFT_KEY = "contactFormDraft";
  const INBOX_KEY = "contactInbox";

  const form = document.getElementById('contactForm');
  const alertBox = document.getElementById('alertBox');

  // Load draft on start
  (function loadDraft() {
    const draft = JSON.parse(sessionStorage.getItem(DRAFT_KEY) || "{}");
    ["name","email","subject","message"].forEach(id => {
      if (draft[id]) document.getElementById(id).value = draft[id];
    });
  })();

  // Autosave draft
  form.addEventListener('input', () => {
    const draft = {
      name: form.name.value.trim(),
      email: form.email.value.trim(),
      subject: form.subject.value.trim(),
      message: form.message.value.trim()
    };
    sessionStorage.setItem(DRAFT_KEY, JSON.stringify(draft));
  });

  // Clear draft
  document.getElementById('clearDraft').addEventListener('click', () => {
    sessionStorage.removeItem(DRAFT_KEY);
    form.reset();
    showAlert("Draft cleared.");
  });

  // Submit handler
  form.addEventListener('submit', (e) => {
    e.preventDefault();

    // Trigger built-in validation UI
    if (!form.checkValidity()) {
      form.reportValidity();
      showAlert("Please correct the highlighted fields.");
      return;
    }

    const payload = {
      name: form.name.value.trim(),
      email: form.email.value.trim(),
      subject: form.subject.value.trim(),
      message: form.message.value.trim(),
      timestamp: new Date().toISOString()
    };

    const inbox = JSON.parse(sessionStorage.getItem(INBOX_KEY) || "[]");
    inbox.unshift(payload);
    sessionStorage.setItem(INBOX_KEY, JSON.stringify(inbox));

    sessionStorage.removeItem(DRAFT_KEY);
    form.reset();
    showAlert("Thanks! Your message was recorded in this session.");
    renderInbox();
  });

  function showAlert(text) {
    alertBox.textContent = text;
  }
  function renderInbox() {
    const container = document.getElementById('recentMessages');
    const inbox = JSON.parse(sessionStorage.getItem(INBOX_KEY) || "[]");
    if (inbox.length === 0) {
      container.textContent = "No messages yet.";
      return;
    }
    container.innerHTML = inbox.slice(0,5).map(m => {
      const time = new Date(m.timestamp).toLocaleString();
      return "<div><strong>" + m.subject + "</strong> — " + m.name +
             " (" + m.email + ")<div>" + time + "</div></div>";
    }).join("");
  }
  renderInbox();
</script>
<script src="api_social.js"></script>

</body>
</html>


